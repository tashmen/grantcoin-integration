{% include "thetransitionglobaluser" %}
{% include "thetransitionextheader" %}
<script type="text/javascript">
    Ext.onReady(function() {
		Ext.QuickTips.init();
		
		Ext.define('USDBTCMarket', {
			extend: 'Ext.data.Model',
			fields: [
				{
					name: 'high',
				}, 
				{
					name: 'last',
				},
				{
					name: 'bid'
				},
				{
					name: 'low'
				},
				{
					name: 'ask'
				},
				{
					name: 'volume'
				}
			],
			proxy: 
			{
				extraParams: {
					resource: 'bitstamp',
					command: 'grantcoin',
					action: 'getusdbtcmarketsummary'
				},
				reader: {
					type: 'json',
					rootProperty: 'bitstamp'
				},
				type: 'customphp'
			}
		});
		
		Ext.define('BTCGRTMarket', {
			extend: 'Ext.data.Model',
			fields: [
				{
					name: 'High'
				}, 
				{
					name: 'Low'
				},
				{
					name: 'Volume'
				},
				{
					name: 'Last'
				},
				{
					name: 'Bid'
				},
				{
					name: 'Ask'
				},
				{
					name: 'OpenBuyOrders'
				},
				{
					name: 'OpenSellOrders'
				}
			],
			proxy: 
			{
				extraParams: {
					resource: 'bittrex',
					command: 'grantcoin',
					action: 'getbtcgrtmarketsummary'
				},
				reader: {
					type: 'json',
					rootProperty: 'bittrex'
				},
				type: 'customphp'
			}
		});
		
		var marketPanel = new Ext.panel.Panel({
			title: 'Market Data',
			collapsible: true,
			renderTo: "marketdata",
			layout: 'column',
			width: '700px',
			defaults: {
				style:{
					'margin': '5px'
				}
			},
			items: [
				{
					xtype: 'fieldset',
					columnWidth: 0.5,
					title: 'BitCoin - GrantCoin Market (Powered By: <a href="http://www.bittrex.com">Bittrex</a>)',
					items: [
						{
							xtype: 'form',
							id: 'btcgrtform',
							border: false,
							defaults: {
								labelAlign: 'right'
							},
							items: [
								{
									xtype: 'textfield',
									fieldLabel: 'Bid (BTC)',
									name: 'Bid',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Ask (BTC)',
									name: 'Ask',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'High (BTC)',
									name: 'High',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Low (BTC)',
									name: 'Low',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Last (BTC)',
									name: 'Last',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Volume (GRT)',
									name: 'Volume',
									readOnly: true
								}
							]
						}
					]
				},
				{
					xtype: 'fieldset',
					columnWidth: 0.5,
					title: 'United States Dollars - BitCoin Market (Powered By: <a href="http://www.bitstamp.net">Bitstamp</a>)',
					items: [
						{
							xtype: 'form',
							id: 'usdbtcform',
							border: false,
							defaults: {
								labelAlign: 'right'
							},
							items: [
								{
									xtype: 'textfield',
									fieldLabel: 'Bid ($)',
									name: 'bid',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Ask ($)',
									name: 'ask',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'High ($)',
									name: 'high',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Low ($)',
									name: 'low',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Last ($)',
									name: 'last',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Volume (BTC)',
									name: 'volume',
									readOnly: true
								}
							]
						}
					]
				}
			]
		});
		
		
		var objBTCGRTMarket = new BTCGRTMarket();
		var objUSDBTCMarket = new USDBTCMarket();
		objBTCGRTMarket.load({
			success: function(record, operation){
				Ext.getCmp('btcgrtform').loadRecord(record);
			}
		});
		objUSDBTCMarket.load({
			success: function(record, operation){
				Ext.getCmp('usdbtcform').loadRecord(record);
			}
		});
		
		var myAccount = new Ext.panel.Panel({
			title: 'My Account',
			renderTo: 'myaccount',
			items: [
				{
					xtype: 'form',
					defaults: {
						style:{
							'margin': '5px'
						}
					},
					items: [
						{
							xtype: 'fieldset',
							title: 'Instructions',
							html: 'Use the GrantCoin Address provided below to add GrantCoin to your account.  Once you have added GrantCoin you can use the available balance to make a donation or setup a monthly or yearly subscription.'
						},
						{
							xtype: 'fieldset',
							title: 'Account',
							defaults: {
								labelAlign: 'right',
								labelWidth: 150
							},
							items:[
								{
									xtype: 'textfield',
									fieldLabel: 'GrantCoin Address',
									name: 'address',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Balance (GRT)',
									name: 'balancegrt',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Approximate Value (USD)',
									name: 'balanceusd',
									readOnly: true
								}
							]
						},
						{
							xtype: 'fieldset',
							title: 'Subscription Costs in GRT',
							defaults: {
								labelAlign: 'right',
								labelWidth: 150
							},
							items: [
								{
									xtype: 'textfield',
									fieldLabel: 'Monthly Subscription',
									name: 'monthlysubgrt',
									readOnly: true
								},
								{
									xtype: 'textfield',
									fieldLabel: 'Yearly Subscription',
									name: 'yearlysubgrt',
									readOnly: true
								}
							]
						},
						{
							xtype: 'fieldset',
							title: 'Actions',
							defaults: {
								labelAlign: 'right',
								labelWidth: 150
							},
							items: [
								{
									xtype: 'combo',
									fieldLabel: 'Action',
									valueField: 'id',
									displayField: 'name',
									queryMode: 'local',
									width: 350,
									store: 
									{
										xtype: 'store',
										fields: ['id','name'],
										data: [
											{ 
												id: 1, 
												name: 'Donate'
											},
											{
												id: 2,
												name: 'Setup Monthly Subscription'
											},
											{
												id: 3,
												name: 'Setup Yearly Subscription'
											}
										]
									}
								}
							]
						}
					]
				}
			]
		});
	});
</script>


{% include "breadcrumbs" %}

{% if page.headline.size > 0 %}
<h2 class="headline">{{ page.headline }}</h2>
{% endif %}

<div id="content">

  <div id="intro" class="intro">
    <div class="text-content">
      {{ page.basic.content }}
    </div>
  </div>
  
  <p>Disclaimer: The Transition is not liable for any loss of Grantcoin that might occur through use of software, apps, or web-based services provided for free by The Transition or by any third party, and users accept the risks and take responsibility for their own use of such products and services.</p>
  
  <br>
  <br>
  <div id="myaccount"></div>
  <br>
  <br>
  <div id="marketdata"></div>

  {% if page.tags_count > 0 %}
  <div class="page-tags">
    {% include "page_tags" with page %}
  </div>
  {% endif %}

  {% if page.is_homepage? == true and site.page_tags contains "homepage" %}
    {% tag "homepage" with "homepage_widget" %}
  {% endif %}

  <div class="like-page">
    <strong>Do you like this page?</strong>
    {% include "like_page" %}
  </div>

  {% if page.show_stream? %}
  {% include "page_stream" %}
  {% endif %}

</div>

{% include "donateLink" with "pay_what_you_want" %} 